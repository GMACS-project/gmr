<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compare Gmacs version — CompareCodeVersion • gmr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compare Gmacs version — CompareCodeVersion"><meta property="og:description" content="Function to run test of comparison between two code versions of
Gmacs."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gmr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="far fa-file-code fa-lg"></span>
     
    Functions
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-file-contract fa-lg"></span>
     
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/1_UseGmrToRunGMACS.html">Run GMACS</a>
    </li>
  </ul></li>
<li>
  <a href="https://github.com/GMACS-project/User-manual" class="external-link">
    <span class="fas fa-book fa-lg"></span>
     
    About GMACS
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-check-square"></span>
     
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../news/index.html">Changelog</a>
    </li>
    <li>
      <a href="https://github.com/GMACS-project/gmr/releases/tag/V1.3.7" class="external-link">gmr V 1.3.7</a>
    </li>
    <li>
      <a href="https://github.com/GMACS-project/gmr/releases/tag/V1.3.6" class="external-link">gmr V 1.3.6</a>
    </li>
    <li>
      <a href="https://github.com/GMACS-project/gmr/releases/tag/V1.3.5" class="external-link">gmr V 1.3.5</a>
    </li>
    <li>
      <a href="https://github.com/GMACS-project/gmr/releases/tag/V1.3.4" class="external-link">gmr V 1.3.4</a>
    </li>
    <li>
      <a href="https://github.com/GMACS-project/gmr/releases/tag/V1.3.3" class="external-link">gmr V 1.3.3</a>
    </li>
    <li>
      <a href="https://github.com/GMACS-project/gmr/releases/tag/V1.3.0" class="external-link">gmr V 1.3.0</a>
    </li>
    <li>
      <a href="https://github.com/GMACS-project/gmr/releases/tag/V1.2.0" class="external-link">gmr V 1.2.0</a>
    </li>
    <li>
      <a href="https://github.com/GMACS-project/gmr/releases/tag/V0.1.1.0" class="external-link">gmr V 0.1.1.0</a>
    </li>
    <li>
      <a href="https://github.com/GMACS-project/gmr/releases/tag/V0.1.0.0" class="external-link">gmr V 0.1.0.0</a>
    </li>
  </ul></li>
<li class="dropdown-header">Contribute</li>
<li>
  <a href="https://github.com/GMACS-project/gmr/issues" class="external-link">
    <span class="fas fa-question-circle fa-lg"></span>
     
    Issues
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/GMACS-project/gmr" class="external-link">
    <span class="fa fa-github"></span>
     
    Source Code
  </a>
</li>
<li>
  <a>
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compare Gmacs version</h1>
    <small class="dont-index">Source: <a href="https://github.com/GMACS-project/gmr/blob/HEAD/R/CompareCodeVersion.R" class="external-link"><code>R/CompareCodeVersion.R</code></a></small>
    <div class="hidden name"><code>CompareCodeVersion.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to run test of comparison between two code versions of
Gmacs.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CompareCodeVersion</span><span class="op">(</span></span>
<span>  stock <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dir_test <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dir_old_version <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dir_OLD_Gmacs_Exe <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dir_Gmacs_Exe <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dir_InputFiles <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  usePin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Run_old_version <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  compareWithPin <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Threshold <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose_shell <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Clean_Files <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>stock</dt>
<dd><p>(character; vector)- the of the stock to be tested. This specified
the input file folder names in the <code>dir_test</code> repertory.</p></dd>


<dt>dir_test</dt>
<dd><p>(path)- path to the repertory where the output of Gmacs
ran for each <code>stock</code> using the new version will be saved saved. This
repertory will be used to run tests and make comparison between Gmacs code
version.</p></dd>


<dt>dir_old_version</dt>
<dd><p>(path)- path to the repertory where the output of Gmacs
ran for each <code>stock</code> using the version to be compared with are saved. The
names of the folders in that repertory have to match the ones in the <code>stock</code>
argument.</p></dd>


<dt>dir_OLD_Gmacs_Exe</dt>
<dd><p>(path)- path to the repertory where the .TPL file of the
old Gmacs version is saved. If empty, this is set equal to
<code>dirname(dir_old_version)</code>.</p></dd>


<dt>dir_Gmacs_Exe</dt>
<dd><p>(path)- path to the repertory where the .TPL file of the
new Gmacs version is saved. If empty, this is set equal to <code>dir_test</code>.</p></dd>


<dt>dir_InputFiles</dt>
<dd><p>(path)- path to the repertory where the input files for
each stock for the newly developed version of Gmacs are saved.</p></dd>


<dt>usePin</dt>
<dd><p>(logical)- flag to use the <code>gmacs.pin</code> as pin file to initialize
parameter values when running the new version. This assumes that the <code>gmacs.par</code>
file structure remained the same between the two versions.</p></dd>


<dt>Run_old_version</dt>
<dd><p>(logical)- flag to re run the old version of Gmacs using
the estimated values for the parameters as a pin file. This will allow to get
a new <code>gmacs.par</code> file that will be then used for comparison. Default,
<code>Run_old_version = TRUE</code>.</p></dd>


<dt>compareWithPin</dt>
<dd><p>(logical)- flag to make comparison with the .pin file
instead of the gmacs.par file obtained with the version to be compared with.</p></dd>


<dt>Threshold</dt>
<dd><p>(numeric)- Threshold to test if the comparison between the
two versions passed. It is used to compared parameter values between the two
version. by default, <code>Threshold = 1.0e-5</code>.</p></dd>


<dt>Clean_Files</dt>
<dd><p>(logical)- flag to delete Gmacs files in stock specific folder
after running the new version. See the <code><a href="clean_bat.html">clean_bat()</a></code> function for more details.</p></dd>


<dt>verbose;verbose_shell</dt>
<dd><p>(logical)- flag to print processing information
and shell output. Default, <code>verbose;verbose_shell = TRUE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with the results of the comparison. This list is also saved
as a <code>.Rdata</code> file under the name <code>Results_testing_version_XXX_[runDate]</code> in
the relative folder of the <code>dir_test</code> repertory, i.e., in the <code>Testing_Versions</code></p>


<p>folder if the workflow to update/upgrade Gmacs has been followed.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>When <code>Run_old_version = TRUE</code>, the function assumes that the <code>gmacs.exe</code>
for the old version is saved in the relative folder of the <code>dir_old_version</code>
folder. If that is not the case, the <code>gmacs.exe</code> will be build based on the
Gmacs codes available in that folder. See the <code><a href="createGmacsExe.html">createGmacsExe()</a></code> function.</p>
<p>Using the pin file to initialize a model run (<code>usePin=TRUE</code>) also sets
the starting phase to 10. If all is well, the model should converge almost
immediately if the pin file is a copy of a par file from a previous converged
model run. Ideally, the model should converge immediately, with the resulting
par file identical to the pin file. However, this is frequently not the case
if parameter values are near a bound in the pin file and thus the resulting par
file values may not be identical to those in the pin file (i.e., the model
converged to a slightly different place in parameter space). For the purpose of
quickly testing the impact of changes to the code on previous model results, it
is probably best to test the par file obtained using the new code run with the
pin file against a par file from the old code that was the result of using the
same pin file to initialize that model run.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>W. Stockhausen; M. Veron</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Load package ----</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gmacs-project.github.io/gmr/" class="external-link">gmr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set directories ----</span></span></span>
<span class="r-in"><span><span class="va">Dir_Dvpt_Vers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Dvpt_Version"</span>, fsep <span class="op">=</span> <span class="va">fsep</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Dir_Last_Vers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Latest_Version"</span>, fsep <span class="op">=</span> <span class="va">fsep</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dir_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Testing_Versions"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Testing new version of Gmacs ----</span></span></span>
<span class="r-in"><span><span class="va">Res</span> <span class="op">&lt;-</span> <span class="fu">CompareCodeVersion</span><span class="op">(</span>stock <span class="op">=</span> <span class="st">"all"</span>,</span></span>
<span class="r-in"><span>dir_test <span class="op">=</span> <span class="va">dir_test</span>,</span></span>
<span class="r-in"><span>dir_old_version <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">Dir_Last_Vers</span>, <span class="st">'build'</span>, fsep <span class="op">=</span> <span class="va">fsep</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>dir_new_version <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">Dir_Dvpt_Vers</span>, <span class="st">'build'</span>, fsep <span class="op">=</span> <span class="va">fsep</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>dir_Gmacs_Exe <span class="op">=</span> <span class="va">dir_Gmacs_Exe</span>,</span></span>
<span class="r-in"><span>dir_InputFiles <span class="op">=</span> <span class="va">dir_InputFiles</span>,</span></span>
<span class="r-in"><span>dir_OLD_Gmacs_Exe <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>Run_old_version <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>usePin <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>compareWithPin <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>Threshold <span class="op">=</span> <span class="fl">1.0e-5</span>,</span></span>
<span class="r-in"><span>Clean_Files <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Matthieu Veron, Cody Szuwalski.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

